<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Accueil</title>
</head>
<body>
    <h1>Bienvenue!</h1>
    {% if user %}
        <p>Connecté en tant que {{ user.email }}</p>
        <a href="{{ url_for('logout') }}">Déconnexion</a>
        <a href="{{ url_for('panier') }}">Mon Panier</a>
    {% else %}
        <a href="{{ url_for('login') }}">Connexion</a>
        <a href="{{ url_for('register') }}">S'inscrire</a>
    {% endif %}

    <h2>Recherche</h2>
    <form method="post">
        <input type="text" name="query" placeholder="Rechercher un article" required>
        <input type="text" name="start_year" placeholder="Année de début (YYYY)">
        <input type="text" name="end_year" placeholder="Année de fin (YYYY)">
        <button type="submit">Rechercher</button>
    </form>

    <h2>Résultats PubMed</h2>
    <ul>
        {% for result in results_pubmed %}
            <li>
                <strong>{{ result.Titre }}</strong> ({{ result.Année }}) - <a href="{{ result.Lien }}">Voir</a>
                {% if user %}
                    <form action="{{ url_for('ajouter_article') }}" method="post">
                        <input type="hidden" name="titre" value="{{ result.Titre }}">
                        <input type="hidden" name="annee" value="{{ result.Année }}">
                        <input type="hidden" name="lien" value="{{ result.Lien }}">
                        <button type="submit">Ajouter au panier</button>
                    </form>
                {% endif %}
            </li>
        {% endfor %}
    </ul>

    <h2>Résultats Scholarly</h2>
    <ul>
        {% for result in results_scholarly %}
            <li>
                <strong>{{ result.Titre }}</strong> ({{ result.Année }}) - <a href="{{ result.Lien }}">Voir</a>
                {% if user %}
                    <form action="{{ url_for('ajouter_article') }}" method="post">
                        <input type="hidden" name="titre" value="{{ result.Titre }}">
                        <input type="hidden" name="annee" value="{{ result.Année }}">
                        <input type="hidden" name="lien" value="{{ result.Lien }}">
                        <button type="submit">Ajouter au panier</button>
                    </form>
                {% endif %}
            </li>
        {% endfor %}
    </ul>

    {% with messages = get_flashed_messages() %}
        {% if messages %}
            <ul>
            {% for message in messages %}
                <li>{{ message }}</li>
            {% endfor %}
            </ul>
        {% endif %}
    {% endwith %}
</body>
</html>
